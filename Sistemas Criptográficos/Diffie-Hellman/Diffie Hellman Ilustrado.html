
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Diffie - Hellman: Ilustración &#8212; Teoría de la Computación - Criptografía</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.da26317cf37e5c4af2fa3e6253912353.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/text-align.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/icon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Diffie - Hellman: Teoría" href="Diffie%20Hellman%20Teor%C3%ADa.html" />
    <link rel="prev" title="Introducción a la Criptografía" href="../../Historia/Chapter%201.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo_uniandes.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Teoría de la Computación - Criptografía</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Historia
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Historia/Chapter%201.html">
   Introducción a la Criptografía
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Diffie-Hellman
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Diffie - Hellman: Ilustración
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Diffie%20Hellman%20Teor%C3%ADa.html">
   Diffie - Hellman: Teoría
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Diffie%20Hellman%20Pr%C3%A1ctico.html">
   Diffie - Hellman: Práctica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  RSA
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../RSA/Ilustraci%C3%B3n%20RSA.html">
   Chocolatería
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../RSA/Teor%C3%ADa%20de%20RSA.html">
   Teoría de RSA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../RSA/RSA%20en%20pr%C3%A1ctica.html">
   RSA en práctica
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Sistemas Criptográficos/Diffie-Hellman/Diffie Hellman Ilustrado.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mantimantilla/Theory-of-Computation-Encryption"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mantimantilla/Theory-of-Computation-Encryption/issues/new?title=Issue%20on%20page%20%2FSistemas Criptográficos/Diffie-Hellman/Diffie Hellman Ilustrado.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivacion">
   Motivación
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#primeros-conceptos">
   Primeros conceptos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#idea-general">
     Idea general
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compromiso">
     Compromiso
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#protocolo">
   Protocolo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vulnerabilidades">
   Vulnerabilidades
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ataque-de-intermediario-man-in-the-middle">
     Ataque de intermediario (Man in the Middle)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward-secrecy-pfs">
     Forward secrecy (PFS)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusiones">
   Conclusiones
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!-- #region -->
<div class="section" id="diffie-hellman-ilustracion">
<h1>Diffie - Hellman: Ilustración<a class="headerlink" href="#diffie-hellman-ilustracion" title="Permalink to this headline">¶</a></h1>
<div class="section" id="motivacion">
<h2>Motivación<a class="headerlink" href="#motivacion" title="Permalink to this headline">¶</a></h2>
<p>Con el advenimiento de la criptografía de llave pública, resultaba imperativo el desarrollo de un sistema robusto para establecer un canal de comunicación seguro. Procedimientos anteriores bajo la premisa de llaves privadas requerían convenir un intercambio presencial o vulnerable y expuesto de llaves para encriptar y desencriptar el contenido de los mensajes del canal establecido. Los primeros sistemas de criptografía de llave pública como el knapsack contemplan un procedimiento de generación de llaves que en su momento parecía robusto pero que, según el trabajo de los creadores del RSA, es susceptible a ataques altamente eficientes que permiten calcular las claves privadas en tiempo polinomial.</p>
<p>El knapsack, como sistema de encriptación, presenta procedimientos para cada etapa y ciclo de un canal de comunicación. Una vez establecidas las claves, puede establecerse la comunicación encriptando mensajes, liberándolos y desencriptándolos en su destino. Aunque existen posibles vulnerabilidades en cada etapa, nosotros nos enfocaremos por ahora en el procedimiento para la generación e intercambio de claves, Diffie-Hellman. Sistemas robustos de encriptación como el RSA apalancan su funcionamiento desde el procedimiento descrito a continuación.</p>
</div>
<div class="section" id="primeros-conceptos">
<h2>Primeros conceptos<a class="headerlink" href="#primeros-conceptos" title="Permalink to this headline">¶</a></h2>
<p>Seguiremos el ejemplo clásico de Alice y Bob. Estos dos personajes deben compartir mensajes el uno con el otro de forma secreta, es decir, sin que algún tercero pueda conocer e interpretar el contenido de los mensajes aún si sabe que existe el canal de comunicación. Como antes mencionado, el procedimiento Diffie Helman permite generar llaves con las cuales encriptar o desencriptar mensajes. Por lo pronto estudiaremos el proceso para alcanzar este <em>secreto compartido</em>.</p>
<div class="section" id="idea-general">
<h3>Idea general<a class="headerlink" href="#idea-general" title="Permalink to this headline">¶</a></h3>
<p>La comunicación en secreto, según su descripción inicial, puede describirse por la siguiente secuencia de pasos (Suponga un escenario donde Alice quiere enviar un mensaje a Bob):</p>
<ol class="simple">
<li><p>Alice tiene un mensaje que quiere enviar a Bob.</p></li>
<li><p>Independiente de como convinieron un secreto compartido, Alice utiliza el secreto para encriptar el mensaje.</p></li>
<li><p>Alice publica su cifrado en la red con Bob como destinatario (Aunque cualquiera podría interceptarlo).</p></li>
<li><p>Bob utiliza el mismo secreto compartido para desencriptar el cifrado y leerlo.</p></li>
</ol>
<p>Estos pasos describen la comunicación entre dos partes simétrica. Veamos ahora su contraparte asimétrica.</p>
<ol class="simple">
<li><p>Alice tiene un mensaje que quiere enviar a Bob.</p></li>
<li><p>Alice conoce la llave pública (accesible por todo interesado) de Bob y encripta su mensaje con la llave.</p></li>
<li><p>El cifrado solo puede desencriptarse con la llave privada de Bob. Las claves existen en pares, siendo la versión pública del destinatario la que se usa para encriptar el mensaje y la privada para desencriptarlo.</p></li>
<li><p>Alice publica su cifrado en la red con Bob como destinatario (Aunque cualquiera podría interceptarlo).</p></li>
<li><p>Bob, como único conocedor de su llave privada, desencripta y lee el mensaje original de Alice.</p></li>
</ol>
<p>Este procedimiento es susceptible a vulnerabilidades que estudiaremos con más detalle pronto. Note que hasta ahora Alice y Bob no comparten información más allá del mensaje encriptado y la clave para encriptar. El valor de este procedimiento está en que idealmente la clave privada es desconocida por todos menos por el destinatario. En teoría, siempre podría establecerse un canal de comunicación por encriptación asimétrica. En práctica, para que el cifrado con una llave pública sea seguro debe hacerse con claves que exigen un alto costo computacional. En su lugar, sería preferible establecer un canal de comunicación por encriptación simétrica. Tenemos entonces el siguiente escenario.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-nota admonition">
<p class="admonition-title">Nota</p>
<p>Tecnologías como la criptografía de curva elíptica vuelven el intercambio asimétrico más factible, aunque no lo contemplamos en nuestra investigación.</p>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-nota admonition">
<p class="admonition-title">Nota</p>
<p>Una red pública no necesariamente se refiera al contexto digital. Estos procedimientos son valiosos bajo cualquier contexto donde la comunicación entre partes es vulnerable a terceros.</p>
</div>
</div>
<p>Alice y Bob pertenecen a una red pública y quieren comunicarse de manera privada. Pueden establecer cada vez su canal por encriptación asimétrica, pero esto es altamente ineficiente. Pueden también establecer un canal de comunicación simétrico, pero para este deben ya compartir una clave con la que encriptar y desencriptar mensajes y convenir una en una red pública es altamente riesgoso. Un escenario ideal sería en el que Alice y Bob pudieran convenir una clave o <em>secreto compartido</em> sin que los otros miembros de la red se enteren para poder comunicarse con encriptación simétrica.</p>
</div>
<div class="section" id="compromiso">
<h3>Compromiso<a class="headerlink" href="#compromiso" title="Permalink to this headline">¶</a></h3>
<p>En 1976 Whitfield Diffie y Martin Hellman publicaron un método que permite establecer un <em>secreto compartido</em> entre dos partes para habilitar un canal de comunicación eficiente. El objetivo es generar una llave privada conocida por ambas partes de forma que puedan de forma eficiente encriptar y desencriptar de forma simétrica la información que se comparten. Las ineficiencias de la criptografía asimétrica son evidentes si el objetivo es compartir muchos mensajes extensos, pero para un paso sencillo, como compartir una llave de encriptación simétrica, resulta atractiva la comunicación asimétrica.</p>
<p>En términos generales, el protocolo de intercambio de llaves Diffie-Hellman establece una instancia de un canal de comunicación asimétrica para compartir información entre dos partes en una única ocasión para esa sesión (Luego veremos que restringir una sesión a un único mensaje puede ser atractivo). En esta instancia, las partes generan una llave simétrica a partir de sus claves privadas y públicas, conocida solo por ellos, para luego establecer un canal de comunicación simétrico, descifrable solo por los dos con una misma llave compartida.</p>
</div>
</div>
<div class="section" id="protocolo">
<h2>Protocolo<a class="headerlink" href="#protocolo" title="Permalink to this headline">¶</a></h2>
<p>Veamos de forma ilustrativa el protocolo en acción. Entraremos en detalle de los aspectos matemáticos en la siguiente página.
Se dijo con anterioridad, que el algoritmo Diffie-Hellman inicia una instancia de comunicación asimétrica, pero esta es distinta a lo que ya describimos.</p>
<p><img alt="" src="../../_images/Animacion-1.gif" /></p>
<p>Note en la animación que a cada parte le corresponde un espacio privado (seguro para los secretos) y comparten un espacio público disponible para ellos y cualquier tercero.</p>
<ol class="simple">
<li><p>En lugar de Alice y Bob definir una llave pública y una llave privada respectivamente, solo nos interesa que definan su llave privada (<span class="math notranslate nohighlight">\(a\)</span> y <span class="math notranslate nohighlight">\(b\)</span>) y que acuerden entre sí, expuestos al público, dos valores <span class="math notranslate nohighlight">\(g\)</span> y <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ol>
<p><img alt="" src="../../_images/Animacion-2.gif" /></p>
<p>Note que al pie de cada región llevamos un registro de las variables a las que han tenido acceso sus respectivos usuarios.</p>
<p><img alt="" src="../../_images/Animacion-3.gif" /></p>
<ol class="simple">
<li><p>Con sus respectivas claves privadas, Alice y Bob computan un valor combinado con el generador <span class="math notranslate nohighlight">\(g\)</span> (recuerde que <span class="math notranslate nohighlight">\(g\)</span> es público). Este proceso de ‘mezclar’ los valores tiene un sentido matemático específico que impide que se pueda deshacer la operación (No es imposible pero sí en exceso dificil y costoso). Respectivamente, Alice y Bob produjeron los valores <span class="math notranslate nohighlight">\(ag\)</span> y <span class="math notranslate nohighlight">\(bg\)</span> de los cuales no se pueden inferir las claves privadas <span class="math notranslate nohighlight">\(a\)</span> y <span class="math notranslate nohighlight">\(b\)</span>. Sin <span class="math notranslate nohighlight">\(p\)</span>, esta operación es imposible.</p></li>
</ol>
<p><img alt="" src="../../_images/Animacion-4.gif" /></p>
<ol class="simple">
<li><p>Una vez generados estos cifrados, Alice y Bob los intercambian. Note que como aún no hay un canal seguro de comunicación, <span class="math notranslate nohighlight">\(ag\)</span> y <span class="math notranslate nohighlight">\(bg\)</span> son públicos.</p></li>
</ol>
<p><img alt="" src="../../_images/Animacion-5.gif" /></p>
<ol class="simple">
<li><p>Nuevamente realizamos la operación de ‘mezclado’. Alice mezclará el cifrado público que acaba de recibir de Bob con su clave privada (<span class="math notranslate nohighlight">\(bg\)</span> con <span class="math notranslate nohighlight">\(a\)</span>, produce <span class="math notranslate nohighlight">\(abg\)</span>). Bob, hará lo mismo con su clave privada y el cifrado público que recibió de Alice (<span class="math notranslate nohighlight">\(ag\)</span> on <span class="math notranslate nohighlight">\(b\)</span>, produce <span class="math notranslate nohighlight">\(abg\)</span>).</p></li>
</ol>
<p><img alt="" src="../../_images/Animacion-6.gif" /></p>
<p>Note que ahora Alice y Bob comparten un cifrado irreversible (idéntico para ambos) el cual pueden utilizar para encriptar cualquier mensaje consecuente. Alice y Bob pueden ahora establecer un canal de comunicación seguro, con encriptación simétrica.</p>
<p>Veamos ahora, que únicamente Alice y Bob pueden generar la llave simétrica <span class="math notranslate nohighlight">\(abg\)</span>. El público tiene acceso al generador <span class="math notranslate nohighlight">\(g\)</span>, el valor <span class="math notranslate nohighlight">\(p\)</span> y las llaves cifradas <span class="math notranslate nohighlight">\(ag\)</span> y <span class="math notranslate nohighlight">\(bg\)</span>. No hay forma de ‘mezclar’ estos valores de forma tal que generen <span class="math notranslate nohighlight">\(abg\)</span>. Intentar ‘mezclar’ <span class="math notranslate nohighlight">\(bg\)</span> con <span class="math notranslate nohighlight">\(ag\)</span> produciría algo como <span class="math notranslate nohighlight">\(abgg\)</span>, lo cual es un valor completamente distinto y que no sirve para descifrar los mensajes entre Alice y Bob. ¡Hemos establecido un canal seguro de encriptación simétrica!</p>
<p><img alt="" src="../../_images/Animacion-7.gif" /></p>
</div>
<div class="section" id="vulnerabilidades">
<h2>Vulnerabilidades<a class="headerlink" href="#vulnerabilidades" title="Permalink to this headline">¶</a></h2>
<p>El procedimiento parece robusto, pero su intención es solo escudar a 2 partidos de un ojo fisgón. ¿Qué pasa cuando introducimos a una tercera parte, Mallory, que tiene el poder de interceptar y manipular mensajes entre partes en la red? Tenemos también la preocupación de que información secreta de alguna de las partes sea liberada al público. ¿Podemos satisfacer que los mensajes previos están seguros?</p>
<div class="section" id="ataque-de-intermediario-man-in-the-middle">
<h3>Ataque de intermediario (Man in the Middle)<a class="headerlink" href="#ataque-de-intermediario-man-in-the-middle" title="Permalink to this headline">¶</a></h3>
<p>Suponga un mismo escenario donde Alice y Bob quieren establecer un canal de comunicación de encriptación simétrica, solo que ahora una tercera parte, Mallory, puede intervenir sobre la información que viaja en la red. Por ejemplo, si Alice quisiera mandar su propuesta de un generador <span class="math notranslate nohighlight">\(g\)</span> a Bob, Mallory sabría que esto está sucediendo evitar que esto suceda, o escoger su propio mensaje para enviarle a Bob. Note que hasta ahora, nuestro método de comunicación no tiene forma de validar el origen de un mensaje en la red, por lo que Mallory puede estar seguro de que su intromisión en el canal de Alice y Bob no es detectable (aún).</p>
<p>El concepto de este ataque es bastante sencillo. Todo lo que debe hacer Mallory para poder interpretar todos los futuros mensaje entre Alice y Bob es suplantarlos al momento de generar la llave compartida, de forma que Mallory comparte una llave con Bob y una con Alice.</p>
<ol class="simple">
<li><p>Alice y Bob acuerdan un <span class="math notranslate nohighlight">\(g\)</span> y <span class="math notranslate nohighlight">\(p\)</span> públicos y generan sus llaves privadas respectivas.</p></li>
<li><p>Alice genera <span class="math notranslate nohighlight">\(ag\)</span> y lo publica en la red con la intención de que lo reciba Bob. Bob hace lo mismo para Alice con <span class="math notranslate nohighlight">\(bg\)</span>.</p></li>
<li><p>Mallory intercepta estos mensajes y evita que lleguen al destinatario correspondiente.</p></li>
<li><p>Mallory genera su propia llave privada <span class="math notranslate nohighlight">\(m\)</span> y produce <span class="math notranslate nohighlight">\(mg\)</span>.</p></li>
<li><p>Mallory responde a Alice con <span class="math notranslate nohighlight">\(mg\)</span> suplantando a Bob. Alice cree que lo que acaba de recibir es <span class="math notranslate nohighlight">\(bg\)</span>.</p></li>
<li><p>Mallory responde a Bob con <span class="math notranslate nohighlight">\(mg\)</span> suplantando a Alice. Bob cree que lo que acaba de recibir es <span class="math notranslate nohighlight">\(ag\)</span>.</p></li>
<li><p>Alice y Bob calculan respectivamente <span class="math notranslate nohighlight">\(mag\)</span> y <span class="math notranslate nohighlight">\(mbg\)</span>.</p></li>
<li><p>Mallory calcula <span class="math notranslate nohighlight">\(mag\)</span> y <span class="math notranslate nohighlight">\(mbg\)</span>. Ahora comparte un secreto con el cual establecer un canal encriptado simétrico con ambos Alice y Bob. Estos no se han percatado del ataque.</p></li>
<li><p>Cualquier cifrado enviado por Alice con la intensión de que lo reciba únicamente Bob, llega primero a Mallory. Mallory puede decidir hacer lo que quiera con este. Si la intención es solo mediar la comunicación entre Alice y Bob, Mallory debe descifrar el cifrado entrante y encriptarlo con el secreto contrario. Esto le permite editarlo, borrarlo, o incluso compartirlo con otros.</p></li>
</ol>
<p>Esta vulnerabilidad fue descubierta pronto, por lo cual se volvió una práctica común agregar un paso de autenticación al cifrado simétrico. Entran ahora en juego las llaves públicas.</p>
<p>Una vez establecido el canal de comunicación entre Alice y Bob, estos se enviarán mensajes entre sí encriptando y descifrando con la clave compartida. Recordemos que al generar una llave privada <span class="math notranslate nohighlight">\(a\)</span> o <span class="math notranslate nohighlight">\(b\)</span>, esta puede generarse con una llave complementaria pública. Por este método, un mensaje encriptado con una clave (privada o pública) solo puede descifrarse con su complemento. Si por ejemplo Alice encriptara un mensaje con la llave pública de Bob, solo Bob podría descifrarlo. Si Alice encriptara con su clave privada, todos podrían descifrar el código con su clave pública. Este segundo escenario parece poco sensato, pero tiene un beneficio crucial y es que al descifrar con la llave pública de Alice, el recipiente tiene asegurado que el mensaje fue encriptado por Alice con su llave privada. Planteamos entonces el siguiente protocolo de intercambio de llaves.</p>
<ol class="simple">
<li><p>Alice y Bob quieren establecer una canal de comunicación encriptado.</p></li>
<li><p>Alice encripta su llave a intercambiar con Bob, <span class="math notranslate nohighlight">\(ag\)</span>, con su clave privada.</p></li>
<li><p>Bob encripta su llave a intercambiar con Alice, <span class="math notranslate nohighlight">\(bg\)</span>, con su clave privada.</p></li>
<li><p>Alice y Bob intercambian en público sus llaves.</p></li>
<li><p>Alice valida que la llave que recibió pertenece a Bob, al descifrarla con la clave pública de Bob.</p></li>
<li><p>Bob valida que la llave que recibió pertenece a Alice, al descifrarla con la clave pública de Alice.</p></li>
<li><p>El protocolo de Diffie Hellman procede como es usual.</p></li>
<li><p>Todos los mensajes consecuentes deben encriptarse con la clave pública del remitente para autenticar su identidad.</p></li>
</ol>
<p>Si Mallory hubiera querido intervenir en el intercambio de llaves, su influencia hubiera sido evidente ya que no tiene la llave privada de Alice o de Bob con la cual generar la llave <span class="math notranslate nohighlight">\(mg\)</span> y que los respectivos destinatarios la acepten en su proceso de suplantación.</p>
</div>
<div class="section" id="forward-secrecy-pfs">
<h3>Forward secrecy (PFS)<a class="headerlink" href="#forward-secrecy-pfs" title="Permalink to this headline">¶</a></h3>
<p><em>Forward secrecy</em> es la intención de proteger mensajes pasados en caso de que su cifrado haya sido guardado por terceros y el secreto compartido sea publicado. En este caso, la responsabilidad sobre la liberación de estos mensajes no recae sobre alguna falla de Diffie-Hellman. En un inicio mencionamos la noción de una sesión de comunicación. La idea de tener sesiones cortas sobre las cuales habilitar el canal de comunicación es beneficiosa ya que cada vez que se inicie una sesión, la llave compartida puede generarse desde cero en cada ocasión, de forma que, si se libera la clave, solo los mensajes de esa sesión son vulnerables. En teoría, nada impide que utilicemos una nueva llave para cada mensaje o para cada sub-cadena de 126 bits o menos. Recordemos que comunicarse por encriptación asimétrica es un proceso costoso, por lo que quisiéramos minimizar su uso. Cada vez que intercambiamos claves y generamos un secreto compartido estamos efectuando encriptación asimétrica, ya depende de los dueños del canal establecer la frecuencia con la que se generan estas llaves efímeras.</p>
</div>
</div>
<div class="section" id="conclusiones">
<h2>Conclusiones<a class="headerlink" href="#conclusiones" title="Permalink to this headline">¶</a></h2>
<p>El procedimiento de intercambio de claves, Diffie-Hellman, es seguro para establecer un canal de comunicación seguro y eficiente, pero no es sin sus fallas. Existen variaciones y complementos a este como el RSA o la encriptación por curva elíptica. La combinación de estos tres métodos son el estándar dorado en tecnología de encriptación y son altamente adaptables a las necesidades del contexto. Sigamos a desarrollar los conceptos matemáticos que permiten este protocolo.</p>
<!-- #endregion -->
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mantimantilla/Theory-of-Computation-Encryption",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Sistemas Criptográficos/Diffie-Hellman"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../../Historia/Chapter%201.html" title="previous page">Introducción a la Criptografía</a>
    <a class='right-next' id="next-link" href="Diffie%20Hellman%20Teor%C3%ADa.html" title="next page">Diffie - Hellman: Teoría</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alejandro Mantilla, Camilo Gutierrez, Federico Galvez<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>